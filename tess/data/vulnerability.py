import dateparser


class VulnerabilityEvent:
    def __init__(self, id, date, outcome, details):
        self.id = id
        if date == '':
            self.date = None
        else:
            self.date = dateparser.parse(date)
        if outcome == '':
            self.outcome = None
        else:
            self.outcome = outcome == 'Y'
        self.details = details

    def __str__(self) -> str:
        return "id: {}, date: {},outcome: {}".format(self.id, self.date, self.outcome)


class Vulnerability:
    def __init__(self, keywords, capec, cwe, cvss_exp_score, cvss_vector, references_number, published_date, history, _target=None):
        self.keywords = keywords
        self.capec = capec
        self.cwe = cwe
        self.e_score = cvss_exp_score
        self.cvss_vector = cvss_vector
        self.references_number = references_number
        self.published_date = published_date
        self.history = history
        self._target = _target
    def __str__(self) -> str:
        return "[keywords : {}, cvss_expl: {}, cvss_vector: {}, ref_number: {}]".format(self.keywords, self.e_score,
                                                                                        self.cvss_vector,
                                                                                        self.references_number)
